<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Demo: .some() & .every()</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: sans-serif; background: #f0f2f5; padding: 24px; }
    h1 { font-size: 22px; margin-bottom: 4px; color: #1a1a2e; }
    .subtitle { font-size: 14px; color: #555; margin-bottom: 24px; }
    h2 { font-size: 14px; font-weight: 700; color: #888; text-transform: uppercase; letter-spacing: .6px; margin-bottom: 10px; margin-top: 24px; }

    /* ── Task cards ── */
    .task-grid { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 20px; }
    .task {
      width: 150px; padding: 16px 12px; border-radius: 12px; background: #fff;
      border: 2px solid #dde1e7; font-size: 13px; font-weight: 600; color: #555;
      cursor: pointer; user-select: none; transition: all .25s; text-align: center;
    }
    .task .status-ring {
      width: 32px; height: 32px; border-radius: 50%;
      border: 3px solid #dde1e7; margin: 0 auto 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 16px; transition: all .25s;
    }
    .task.done .status-ring { border-color: #16a34a; background: #dcfce7; }
    .task.done { border-color: #86efac; background: #f0fdf4; color: #15803d; }
    .task .hint { font-size: 10px; color: #aaa; margin-top: 4px; font-weight: 400; }

    /* ── Answer boards ── */
    .answer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 24px; }
    .answer-card {
      border-radius: 12px; padding: 16px 18px; background: #fff;
      border: 2px solid #dde1e7; transition: all .3s;
    }
    .answer-card h3 { font-size: 13px; font-weight: 700; color: #888; margin-bottom: 6px; font-family: monospace; }
    .answer-card .value {
      font-size: 32px; font-weight: 700; color: #dde1e7; transition: color .3s;
    }
    .answer-card .explain { font-size: 12px; color: #aaa; margin-top: 4px; }
    .answer-card.true-state  { border-color: #16a34a; background: #f0fdf4; }
    .answer-card.true-state  .value { color: #16a34a; }
    .answer-card.false-state { border-color: #dc2626; background: #fff5f5; }
    .answer-card.false-state .value { color: #dc2626; }

    .controls { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; background: #fff; padding: 12px 16px; border-radius: 10px; border: 1px solid #e2e8f0; margin-bottom: 14px; }
    .btn { padding: 7px 16px; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; color: #fff; }
    .btn-run { background: #0891b2; } .btn-run:hover { background: #0e7490; }
    .btn-all { background: #16a34a; } .btn-all:hover { background: #15803d; }
    .btn-none { background: #dc2626; } .btn-none:hover { background: #b91c1c; }
    .btn-reset { background: #6b7280; } .btn-reset:hover { background: #4b5563; }

    /* ── Score demo ── */
    .score-grid { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
    .score-card {
      width: 120px; padding: 14px 10px; border-radius: 10px; background: #fff;
      border: 2px solid #dde1e7; text-align: center; font-size: 13px;
      font-weight: 600; color: #555; transition: all .25s;
    }
    .score-card .score-val { font-size: 22px; font-weight: 700; color: #1a1a2e; margin: 4px 0; }
    .score-card input[type=range] { width: 90%; margin-top: 4px; }
    .score-card.pass-score { border-color: #16a34a; background: #f0fdf4; }
    .score-card.fail-score { border-color: #dc2626; background: #fff5f5; }

    .results { display: flex; flex-direction: column; gap: 8px; }
    .result-row { display: flex; align-items: center; gap: 10px; background: #fff; border-radius: 8px; padding: 10px 14px; border-left: 4px solid #ccc; font-size: 14px; color: #333; }
    .result-row.pass { border-left-color: #16a34a; }
    .result-row.fail { border-left-color: #dc2626; background: #fff5f5; }
    .badge { font-size: 11px; font-weight: 700; padding: 2px 8px; border-radius: 99px; flex-shrink: 0; }
    .pass .badge { background: #dcfce7; color: #15803d; }
    .fail .badge { background: #fee2e2; color: #b91c1c; }
  </style>
</head>
<body>
  <h1>Demo — <code>.some()</code> &amp; <code>.every()</code></h1>
  <p class="subtitle">
    <code>.some()</code> returns <code>true</code> if <em>at least one</em> element matches.
    <code>.every()</code> returns <code>true</code> only if <em>all</em> elements match.
    Click tasks to toggle them ✓ done, then watch the answers update live.
  </p>

  <!-- ── Interactive: task checklist ── -->
  <h2>Task checklist — toggle done/undone, watch answers update</h2>
  <div class="task-grid" id="task-grid">
    <div class="task tcard" id="t1" onclick="toggleTask(this)"><div class="status-ring"></div>Design<div class="hint">click to toggle</div></div>
    <div class="task tcard" id="t2" onclick="toggleTask(this)"><div class="status-ring"></div>Backend<div class="hint">click to toggle</div></div>
    <div class="task tcard" id="t3" onclick="toggleTask(this)"><div class="status-ring"></div>Frontend<div class="hint">click to toggle</div></div>
    <div class="task tcard" id="t4" onclick="toggleTask(this)"><div class="status-ring"></div>Tests<div class="hint">click to toggle</div></div>
    <div class="task tcard" id="t5" onclick="toggleTask(this)"><div class="status-ring"></div>Deploy<div class="hint">click to toggle</div></div>
  </div>

  <div class="controls">
    <button class="btn btn-all"   onclick="markAll(true)">Mark all done</button>
    <button class="btn btn-none"  onclick="markAll(false)">Mark all undone</button>
  </div>

  <div class="answer-grid">
    <div class="answer-card" id="some-card">
      <h3>.some(el => el.classList.contains('done'))</h3>
      <div class="value" id="some-val">—</div>
      <div class="explain" id="some-explain">at least one task done?</div>
    </div>
    <div class="answer-card" id="every-card">
      <h3>.every(el => el.classList.contains('done'))</h3>
      <div class="value" id="every-val">—</div>
      <div class="explain" id="every-explain">all tasks done?</div>
    </div>
  </div>

  <!-- ── Score sliders ── -->
  <h2>Score sliders — does everyone pass? (threshold: 60)</h2>
  <div class="score-grid" id="score-grid">
    <div class="score-card scard" id="sc1" data-score="75"><div>Alice</div><div class="score-val" id="sv1">75</div><input type="range" min="0" max="100" value="75" oninput="updateScore('sc1','sv1',this.value)"></div>
    <div class="score-card scard" id="sc2" data-score="82"><div>Bob</div><div class="score-val" id="sv2">82</div><input type="range" min="0" max="100" value="82" oninput="updateScore('sc2','sv2',this.value)"></div>
    <div class="score-card scard" id="sc3" data-score="45"><div>Carol</div><div class="score-val" id="sv3">45</div><input type="range" min="0" max="100" value="45" oninput="updateScore('sc3','sv3',this.value)"></div>
    <div class="score-card scard" id="sc4" data-score="91"><div>Dave</div><div class="score-val" id="sv4">91</div><input type="range" min="0" max="100" value="91" oninput="updateScore('sc4','sv4',this.value)"></div>
  </div>
  <div class="answer-grid" style="margin-top:12px;">
    <div class="answer-card" id="score-some-card">
      <h3>.some(score ≥ 60)</h3>
      <div class="value" id="score-some-val">—</div>
      <div class="explain">any student passing?</div>
    </div>
    <div class="answer-card" id="score-every-card">
      <h3>.every(score ≥ 60)</h3>
      <div class="value" id="score-every-val">—</div>
      <div class="explain">all students passing?</div>
    </div>
  </div>

  <h2>Automated test results</h2>
  <div class="results" id="results"></div>

  <script src="https://cdn.jsdelivr.net/npm/dom-helpers-js@2.4.2/dist/dom-helpers.min.js"></script>
  <script>
    const resultsEl = document.getElementById('results');

    function addResult(pass, label, detail) {
      const row = document.createElement('div');
      row.className = 'result-row ' + (pass ? 'pass' : 'fail');
      row.innerHTML = '<span class="badge">' + (pass ? 'PASS' : 'FAIL') + '</span><strong>' + label + '</strong>' + (detail ? ' — <span style="color:#666">' + detail + '</span>' : '');
      resultsEl.appendChild(row);
    }

    function setAnswerCard(cardId, valId, bool, explain) {
      const card = document.getElementById(cardId);
      const val  = document.getElementById(valId);
      card.className = 'answer-card ' + (bool ? 'true-state' : 'false-state');
      val.textContent = String(bool);
      if (explain) document.getElementById(explain).textContent = bool ? 'Yes ✓' : 'No ✗';
    }

    function updateAnswers() {
      const tasks = Collections.ClassName('tcard');
      const some  = tasks.some(el  => el.classList.contains('done'));
      const every = tasks.every(el => el.classList.contains('done'));
      setAnswerCard('some-card',  'some-val',  some,  'some-explain');
      setAnswerCard('every-card', 'every-val', every, 'every-explain');
    }

    function toggleTask(el) {
      el.classList.toggle('done');
      el.querySelector('.status-ring').textContent = el.classList.contains('done') ? '✓' : '';
      updateAnswers();
    }

    function markAll(done) {
      Collections.ClassName('tcard').forEach(el => {
        if (done) el.classList.add('done'); else el.classList.remove('done');
        el.querySelector('.status-ring').textContent = done ? '✓' : '';
      });
      updateAnswers();
    }

    updateAnswers(); // init

    // ── Score sliders ─────────────────────────────────────────────────────
    function updateScore(cardId, valId, val) {
      document.getElementById(cardId).dataset.score = val;
      document.getElementById(valId).textContent = val;
      updateScoreAnswers();
    }

    function updateScoreAnswers() {
      const scores = Collections.ClassName('scard');
      const some   = scores.some(el  => +el.dataset.score >= 60);
      const every  = scores.every(el => +el.dataset.score >= 60);

      scores.forEach(el => {
        el.classList.toggle('pass-score', +el.dataset.score >= 60);
        el.classList.toggle('fail-score', +el.dataset.score < 60);
      });
      setAnswerCard('score-some-card',  'score-some-val',  some,  null);
      setAnswerCard('score-every-card', 'score-every-val', every, null);
    }

    updateScoreAnswers(); // init

    // ── Automated tests ───────────────────────────────────────────────────
    markAll(false); // start fresh

    const tasks = Collections.ClassName('tcard');
    addResult(typeof tasks.some(()=>true)  === 'boolean', '.some()  returns a boolean', '');
    addResult(typeof tasks.every(()=>true) === 'boolean', '.every() returns a boolean', '');

    // .some() — none done → false
    addResult(tasks.some(el => el.classList.contains('done')) === false, '.some() → false when none match',  '');

    // .every() — none done → false
    addResult(tasks.every(el => el.classList.contains('done')) === false, '.every() → false when none match', '');

    // Mark one task done
    document.getElementById('t1').classList.add('done');
    addResult(tasks.some(el  => el.classList.contains('done')) === true,  '.some() → true when one matches',   '');
    addResult(tasks.every(el => el.classList.contains('done')) === false,  '.every() → false when not all match','');

    // Mark all done
    markAll(true);
    addResult(tasks.some(el  => el.classList.contains('done')) === true,  '.some() → true when all match',   '');
    addResult(tasks.every(el => el.classList.contains('done')) === true,   '.every() → true when all match',  '');

    // Empty collection
    addResult(Collections.ClassName('nope').some(()=>true)  === false, '.some()  on empty collection → false', '');
    addResult(Collections.ClassName('nope').every(()=>true) === true,  '.every() on empty collection → true (vacuously)', '');

    // thisArg
    const ctx = { cls: 'done' };
    addResult(tasks.some(function(el)  { return el.classList.contains(this.cls); }, ctx) === true, '.some()  respects thisArg', '');
    addResult(tasks.every(function(el) { return el.classList.contains(this.cls); }, ctx) === true, '.every() respects thisArg', '');

    markAll(false); // restore UI
    updateAnswers();
  </script>
</body>
</html>
